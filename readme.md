Подредачил, заменил очереди на нужные, требуется помощь по поводу части с перенаправлением данных в Gates + обсуждение по поводу лишнего кода
